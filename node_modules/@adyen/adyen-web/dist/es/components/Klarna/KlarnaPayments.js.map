{"version":3,"file":"KlarnaPayments.js","sources":["../../../../src/components/Klarna/KlarnaPayments.tsx"],"sourcesContent":["import { h } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { CoreProvider } from '../../core/Context/CoreProvider';\nimport PayButton from '../internal/PayButton';\nimport { KlarnaContainer } from './components/KlarnaContainer/KlarnaContainer';\nimport { TxVariants } from '../tx-variants';\nimport type { KlarnaAction, KlarnaAdditionalDetailsData, KlarnaComponentRef, KlarnaConfiguration } from './types';\nimport type { ICore } from '../../core/types';\n\nclass KlarnaPayments extends UIElement<KlarnaConfiguration> {\n    public static type = TxVariants.klarna;\n    public static txVariants = [TxVariants.klarna, TxVariants.klarna_account, TxVariants.klarna_paynow, TxVariants.klarna_b2b];\n\n    public componentRef: KlarnaComponentRef;\n\n    protected static defaultProps = {\n        useKlarnaWidget: false\n    };\n\n    constructor(checkout: ICore, props?: KlarnaConfiguration) {\n        super(checkout, props);\n\n        this.onComplete = this.onComplete.bind(this);\n        this.updateWithAction = this.updateWithAction.bind(this);\n        this.submit = this.submit.bind(this);\n        this.onLoaded = this.onLoaded.bind(this);\n    }\n    get isValid() {\n        return true;\n    }\n\n    protected formatData() {\n        return {\n            paymentMethod: {\n                type: this.type,\n                ...(this.props.useKlarnaWidget ? { subtype: 'sdk' } : {})\n            }\n        };\n    }\n\n    public payButton = props => {\n        return <PayButton amount={this.props.amount} onClick={this.submit} {...props} />;\n    };\n\n    updateWithAction(action: KlarnaAction): void {\n        if (action.paymentMethodType !== this.type) throw new Error('Invalid Action');\n        this.componentRef.setAction(action);\n    }\n\n    private onLoaded() {\n        // When action/widget is loaded, set the 'drop-in' back to ready\n        this.setElementStatus('ready');\n    }\n\n    public override activate() {\n        this.componentRef.reinitializeWidget();\n    }\n\n    protected onComplete(details: KlarnaAdditionalDetailsData): void {\n        this.handleAdditionalDetails(details);\n    }\n\n    render() {\n        return (\n            <CoreProvider i18n={this.props.i18n} loadingContext={this.props.loadingContext} resources={this.resources}>\n                <KlarnaContainer\n                    {...this.props}\n                    setComponentRef={this.setComponentRef}\n                    displayName={this.displayName}\n                    onComplete={this.onComplete}\n                    onError={this.props.onError}\n                    payButton={this.payButton}\n                    onLoaded={this.onLoaded}\n                    showPayButton={this.props.showPayButton}\n                    onActionHandled={this.onActionHandled}\n                    type={this.props.type}\n                />\n            </CoreProvider>\n        );\n    }\n}\n\nexport default KlarnaPayments;\n"],"names":["KlarnaPayments","UIElement","isValid","formatData","paymentMethod","type","this","props","useKlarnaWidget","subtype","updateWithAction","action","paymentMethodType","Error","componentRef","setAction","onLoaded","setElementStatus","activate","reinitializeWidget","onComplete","details","handleAdditionalDetails","render","h","CoreProvider","i18n","loadingContext","resources","KlarnaContainer","setComponentRef","displayName","onError","payButton","showPayButton","onActionHandled","constructor","checkout","super","_define_property","PayButton","amount","onClick","submit","bind","TxVariants","klarna","txVariants","klarna_account","klarna_paynow","klarna_b2b","defaultProps"],"mappings":"ifASA,MAAMA,UAAuBC,EAkBzB,WAAIC,GACA,OAAO,CACX,CAEUC,UAAAA,GACN,MAAO,CACHC,cAAe,CACXC,KAAMC,KAAKD,QACPC,KAAKC,MAAMC,gBAAkB,CAAEC,QAAS,OAAU,CAAE,GAGpE,CAMAC,gBAAAA,CAAiBC,GACb,GAAIA,EAAOC,oBAAsBN,KAAKD,KAAM,MAAM,IAAIQ,MAAM,kBAC5DP,KAAKQ,aAAaC,UAAUJ,EAChC,CAEQK,QAAAA,GAEJV,KAAKW,iBAAiB,QAC1B,CAEgBC,QAAAA,GACZZ,KAAKQ,aAAaK,oBACtB,CAEUC,UAAAA,CAAWC,GACjBf,KAAKgB,wBAAwBD,EACjC,CAEAE,MAAAA,GACI,OACIC,EAACC,EAAAA,CAAaC,KAAMpB,KAAKC,MAAMmB,KAAMC,eAAgBrB,KAAKC,MAAMoB,eAAgBC,UAAWtB,KAAKsB,WAC5FJ,EAACK,EAAAA,IACOvB,KAAKC,MACTuB,gBAAiBxB,KAAKwB,gBACtBC,YAAazB,KAAKyB,YAClBX,WAAYd,KAAKc,WACjBY,QAAS1B,KAAKC,MAAMyB,QACpBC,UAAW3B,KAAK2B,UAChBjB,SAAUV,KAAKU,SACfkB,cAAe5B,KAAKC,MAAM2B,cAC1BC,gBAAiB7B,KAAK6B,gBACtB9B,KAAMC,KAAKC,MAAMF,OAIjC,CA5DA+B,WAAAA,CAAYC,EAAiB9B,GACzB+B,MAAMD,EAAU9B,GAPpBgC,EAAAjC,KAAOQ,oBAAP,GA2BAyB,EAAON,KAAAA,aAAY1B,GACRiB,EAACgB,EAAAA,CAAUC,OAAQnC,KAAKC,MAAMkC,OAAQC,QAASpC,KAAKqC,UAAYpC,MAnBvED,KAAKc,WAAad,KAAKc,WAAWwB,KAAKtC,MACvCA,KAAKI,iBAAmBJ,KAAKI,iBAAiBkC,KAAKtC,MACnDA,KAAKqC,OAASrC,KAAKqC,OAAOC,KAAKtC,MAC/BA,KAAKU,SAAWV,KAAKU,SAAS4B,KAAKtC,KACvC,EAhBAiC,EADEvC,EACYK,OAAOwC,EAAWC,QAChCP,EAFEvC,EAEY+C,aAAa,CAACF,EAAWC,OAAQD,EAAWG,eAAgBH,EAAWI,cAAeJ,EAAWK,aAI/GX,EANEvC,EAMemD,eAAe,CAC5B3C,iBAAiB"}
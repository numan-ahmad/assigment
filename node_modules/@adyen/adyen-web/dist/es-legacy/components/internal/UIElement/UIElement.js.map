{"version":3,"file":"UIElement.js","sources":["../../../../../src/components/internal/UIElement/UIElement.tsx"],"sourcesContent":["import { h } from 'preact';\nimport BaseElement from '../BaseElement/BaseElement';\nimport PayButton from '../PayButton';\nimport { assertIsDropin, cleanupFinalResult, getRegulatoryDefaults, sanitizeResponse, verifyPaymentDidNotFail } from './utils';\nimport AdyenCheckoutError from '../../../core/Errors/AdyenCheckoutError';\nimport { hasOwnProperty } from '../../../utils/hasOwnProperty';\nimport { Resources } from '../../../core/Context/Resources';\nimport { ANALYTICS_SUBMIT_STR } from '../../../core/Analytics/constants';\n\nimport type { AnalyticsInitialEvent, SendAnalyticsObject } from '../../../core/Analytics/types';\nimport type { CoreConfiguration, ICore, AdditionalDetailsData } from '../../../core/types';\nimport type { ComponentMethodsRef, PayButtonFunctionProps, UIElementProps, UIElementStatus } from './types';\nimport type { CheckoutSessionDetailsResponse, CheckoutSessionPaymentResponse } from '../../../core/CheckoutSession/types';\nimport type {\n    ActionHandledReturnObject,\n    CheckoutAdvancedFlowResponse,\n    Order,\n    PaymentAction,\n    PaymentAmount,\n    PaymentData,\n    PaymentMethodsResponse,\n    PaymentResponseData,\n    RawPaymentResponse\n} from '../../../types/global-types';\nimport type { IDropin } from '../../Dropin/types';\nimport type { NewableComponent } from '../../../core/core.registry';\nimport CancelError from '../../../core/Errors/CancelError';\n\nimport './UIElement.scss';\n\nexport abstract class UIElement<P extends UIElementProps = UIElementProps> extends BaseElement<P> {\n    protected componentRef: any;\n\n    protected resources: Resources;\n\n    public elementRef: UIElement;\n\n    public static type = undefined;\n\n    /**\n     * Defines all txVariants that the Component supports (in case it support multiple ones besides the 'type' one)\n     */\n    public static txVariants: string[] = [];\n\n    constructor(checkout: ICore, props?: P) {\n        super(checkout, props);\n\n        this.core.register(this.constructor as NewableComponent);\n\n        this.submit = this.submit.bind(this);\n        this.setState = this.setState.bind(this);\n        this.onComplete = this.onComplete.bind(this);\n        this.handleAction = this.handleAction.bind(this);\n        this.handleOrder = this.handleOrder.bind(this);\n        this.handleAdditionalDetails = this.handleAdditionalDetails.bind(this);\n        this.handleResponse = this.handleResponse.bind(this);\n        this.setElementStatus = this.setElementStatus.bind(this);\n        this.submitAnalytics = this.submitAnalytics.bind(this);\n        this.makePaymentsCall = this.makePaymentsCall.bind(this);\n        this.makeAdditionalDetailsCall = this.makeAdditionalDetailsCall.bind(this);\n        this.submitUsingSessionsFlow = this.submitUsingSessionsFlow.bind(this);\n\n        this.elementRef = (props && props.elementRef) || this;\n        this.resources = this.props.modules ? this.props.modules.resources : undefined;\n\n        this.storeElementRefOnCore(this.props);\n\n        this.onEnterKeyPressed = this.onEnterKeyPressed.bind(this);\n        this.onActionHandled = this.onActionHandled.bind(this);\n    }\n\n    protected override buildElementProps(componentProps?: P) {\n        const globalCoreProps = this.core.getCorePropsForComponent();\n        const isStoredPaymentMethod = !!componentProps?.isStoredPaymentMethod;\n        const paymentMethodsResponseProps = isStoredPaymentMethod\n            ? {}\n            : this.core.paymentMethodsResponse.find(componentProps?.type || this.constructor['type']);\n\n        const finalProps = {\n            showPayButton: true,\n            ...globalCoreProps,\n            ...paymentMethodsResponseProps,\n            ...componentProps\n        };\n\n        const isDropin = assertIsDropin(this as unknown as IDropin);\n\n        this.props = this.formatProps({\n            ...this.constructor['defaultProps'], // component defaults\n            ...getRegulatoryDefaults(this.core.options.countryCode, isDropin), // regulatory defaults\n            ...finalProps // the rest (inc. merchant defined config)\n        });\n    }\n\n    protected storeElementRefOnCore(props?: P) {\n        if (!props?.isDropin) {\n            this.core.storeElementReference(this);\n        }\n    }\n\n    public isAvailable(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    public setState(newState: object): void {\n        this.state = { ...this.state, ...newState };\n        this.onChange();\n    }\n\n    public showValidation(): this {\n        if (this.componentRef && this.componentRef.showValidation) this.componentRef.showValidation();\n        return this;\n    }\n\n    public setElementStatus(status: UIElementStatus, props?: any): this {\n        this.elementRef?.setStatus(status, props);\n        return this;\n    }\n\n    public setStatus(status: UIElementStatus, props?): this {\n        if (this.componentRef?.setStatus) {\n            this.componentRef.setStatus(status, props);\n        }\n        return this;\n    }\n\n    protected onChange(): void {\n        this.props.onChange?.(\n            {\n                data: this.data,\n                isValid: this.isValid,\n                errors: this.state.errors,\n                valid: this.state.valid\n            },\n            this.elementRef\n        );\n    }\n\n    // Only called once, for UIElements (including Dropin), as they are being mounted\n    protected setUpAnalytics(setUpAnalyticsObj: AnalyticsInitialEvent) {\n        const sessionId = this.props.session?.id;\n\n        return this.props.modules.analytics.setUp({\n            ...setUpAnalyticsObj,\n            ...(sessionId && { sessionId })\n        });\n    }\n\n    /**\n     * A function for all UIElements, or BaseElement, to use to create an analytics action for when it's been:\n     *  - mounted,\n     *  - a PM has been selected\n     *  - onSubmit has been called (as a result of the pay button being pressed)\n     *\n     *  In some other cases e.g. 3DS2 components, this function is overridden to allow more specific analytics actions to be created\n     */\n\n    protected submitAnalytics(analyticsObj: SendAnalyticsObject, uiElementProps?) {\n        /** Work out what the component's \"type\" is:\n         * - first check for a dedicated \"analyticsType\" (currently only applies to custom-cards)\n         * - otherwise, distinguish cards from non-cards: cards will use their static type property, everything else will use props.type\n         */\n        try {\n            this.props.modules.analytics.sendAnalytics(this.getComponent(analyticsObj), analyticsObj, uiElementProps);\n        } catch (error) {\n            console.warn('Failed to submit the analytics event. Error:', error);\n        }\n    }\n\n    private getComponent({ component }: SendAnalyticsObject): string {\n        if (component) {\n            return component;\n        }\n        if (this.constructor['analyticsType']) {\n            return this.constructor['analyticsType'];\n        }\n        if (this.constructor['type'] === 'scheme' || this.constructor['type'] === 'bcmc') {\n            return this.constructor['type'];\n        }\n        return this.props.type;\n    }\n\n    public submit(): void {\n        if (!this.isValid) {\n            this.showValidation();\n            return;\n        }\n\n        this.makePaymentsCall()\n            .then(sanitizeResponse)\n            .then(verifyPaymentDidNotFail)\n            .then(this.handleResponse)\n            .catch((e: PaymentResponseData | Error) => {\n                if (e instanceof CancelError) {\n                    this.setElementStatus('ready');\n                    return;\n                }\n                this.handleFailedResult(e as PaymentResponseData);\n            });\n    }\n\n    protected makePaymentsCall(): Promise<CheckoutAdvancedFlowResponse | CheckoutSessionPaymentResponse> {\n        this.setElementStatus('loading');\n\n        if (this.props.onSubmit) {\n            return this.submitUsingAdvancedFlow();\n        }\n\n        if (this.core.session) {\n            const beforeSubmitEvent: Promise<PaymentData> = this.props.beforeSubmit\n                ? new Promise((resolve, reject) =>\n                      this.props.beforeSubmit(this.data, this.elementRef, {\n                          resolve,\n                          reject: () => reject(new CancelError('beforeSubmitRejected'))\n                      })\n                  )\n                : Promise.resolve(this.data);\n\n            return beforeSubmitEvent.then(this.submitUsingSessionsFlow);\n        }\n\n        this.handleError(\n            new AdyenCheckoutError(\n                'IMPLEMENTATION_ERROR',\n                'It can not perform /payments call. Callback \"onSubmit\" is missing or Checkout session is not available'\n            )\n        );\n    }\n\n    private async submitUsingAdvancedFlow(): Promise<CheckoutAdvancedFlowResponse> {\n        return new Promise<CheckoutAdvancedFlowResponse>((resolve, reject) => {\n            // Call analytics endpoint\n            this.submitAnalytics({ type: ANALYTICS_SUBMIT_STR });\n\n            this.props.onSubmit(\n                {\n                    data: this.data,\n                    isValid: this.isValid\n                },\n                this.elementRef,\n                { resolve, reject }\n            );\n        });\n    }\n\n    private async submitUsingSessionsFlow(data: PaymentData): Promise<CheckoutSessionPaymentResponse> {\n        this.submitAnalytics({ type: ANALYTICS_SUBMIT_STR });\n\n        try {\n            return await this.core.session.submitPayment(data);\n        } catch (error: unknown) {\n            if (error instanceof AdyenCheckoutError) this.handleError(error);\n            else this.handleError(new AdyenCheckoutError('ERROR', 'Error when making /payments call', { cause: error }));\n\n            return Promise.reject(error);\n        }\n\n        // // Uncomment to simulate failed\n        // return {\n        //     resultCode: 'Refused',\n        //     sessionData:\n        //         'Ab02b4c0!BQABAgBKGgqfEz8uQlU4yCIOWjA8bkEwmbJ7Qt4r+x5IPXREu1rMjwNk5MDoHFNlv+MWvinS6nXIDniXgRzXCdSC4ksw9CNDBAjOa+B88wRoj/rLTieuWh/0leR88qkV24vtIkjsIsbJTDB78Pd8wX8MEDsXhaAdEIyX9E8eqxuQ3bwPbvLs1Dlgo1ZrfkQRzaNiuVM8ejRG0IWE1bGThJzY+sJvZZHvlDMXIlxhZcDoQvsMj/WwE6+nFJxBiC3oRzmvVn3AbkLQGtvwq16UUSfYbPzG9dXypJMtcrZAQYq2g/2+BSibCcmee9AXq/wij11BERrYmjbDt5NkkdUnDVgAB7pdqbnWX0A2sxBKeYtLSP2kxp+5LoU/Wty3fmcVA3VKVkHfgmIihkeL8lY++5hvHjnkzOE4tyx/sheiKS4zqoWE43TD6n8mpFskAzwMHq4G2o6vkXqvaKFEq7y/R2fVrCypenmRhkPASizpM265rKLU+L4E/C+LMHfN0LYKRMCrLr0gI2GAp+1PZLHgh0tCtiJC/zcJJtJs6sHNQxLUN+kxJuELUHOcuL3ivjG+mWteUnBENZu7KqOSZYetiWYRiyLOXDiBHqbxuQwTuO54L15VLkS/mYB20etibM1nn+fRmbo+1IJkCSalhwi5D7fSrpjbQTmAsOpJT1N8lC1MSNmAvAwG1kWL4JxYwXDKYyYASnsia2V5IjoiQUYwQUFBMTAzQ0E1MzdFQUVEODdDMjRERDUzOTA5QjgwQTc4QTkyM0UzODIzRDY4REFDQzk0QjlGRjgzMDVEQyJ98uZI4thGveOByYbomCeeP2Gy2rzs99FOBoDYVeWIUjyM+gfnW89DdJZAhxe74Tv0TnL5DRQYPCTRQPOoLbQ21NaeSho70FNE+n8XYKlVK5Ore6BoB6IVCaal5MkM27VmZPMmGflgcPx+pakx+EmRsYGdvYNImYxJYrRk3CI+l3T3ZiVpPPqebaVSLaSkEfu0iOFPjjLUhWN6QW6c18heE5vq/pcoeBf7p0Jgr9I5aBFY0avYG57BDGHzU1ZiQ9LLMTis2BA7Ap9pdNq8FVXL4fnoVHNZiiANOf3uvSknPKBID8sdOXUStA0crmO322FYjDqh1n6FG+D7+OJSayNsXIz6Zoy0eFn4HbT8nt8L2X2tdzkMayCYHXRwKh13Xyleqxt4WoEZmhwTmB3p9d1F0SylWnjcC6o/DnshJ9mMW/8D3oWS30Z7BwRODqKGVahRD0YGRzwMbVnEe5JFRfNvJZdLGl35L9632DVmuFQ0lr/8WNL/NrAJNtI6PXrZMNiza0/omPwPfe5ZYuD1Jgq59TX4h9d+3fdkArcJYL7AdoMZON1YEiWY5EzazQwtHd9yzdty9ZHPxAfuOfCh4OhbhFNp+v5YQ+PzKZ+UpM1VxV863+9XgWEURPNvX7qq1cpUSRzrSGq01QBBM3MKzRh5mAgqIdXgtl7L0EXAep0MECc7QY0/o3tW3VR8eEJGsSzrNxpFItqj0SEaIWo25dRfkl5zuw47GQrN9Qzxl2WV3A38MQPUqFtIr/71Rjkphgg49ZGWEYCwgFmm8jJc2/5qTabSGk4bzwiETCTzeydq30bUGqCwglj8CrFViAuQeTJm7dp+PYKMkUNvQRpnSXMj6Kz7rvAMzhzJgK62ltN2idqKxLC7WtivCUgejuQUvNreCYBQCaKwTwP02lZsJpGF9yw8gbyuoB+2aB7IZmgIB8GP4qVQ/ht5B9z/FLohK/8cSPV/4i32SNNdcwhV',\n        //     sessionResult:\n        //         'X3XtfGC7!H4sIAAAAAAAA/6tWykxRslJyDjaxNDMyM3E2MXIyNDUys3RU0lHKTS1KzkjMK3FMTs4vzSsBKgtJLS7xhYo6Z6QmZ+eXlgAVFpcklpQWA+WLUtNKi1NTlGoBMEEbz1cAAAA=iMsCaEJ5LcnsqIUtmNxjm8HtfQ8gZW8JewEU3wHz4qg='\n        // };\n    }\n\n    protected onComplete(state): void {\n        if (this.props.onComplete) this.props.onComplete(state, this.elementRef);\n    }\n\n    protected handleError = (error: AdyenCheckoutError): void => {\n        /**\n         * Set status using elementRef, which:\n         * - If Drop-in, will set status for Dropin component, and then it will propagate the new status for the active payment method component\n         * - If Component, it will set its own status\n         */\n        this.setElementStatus('ready');\n\n        if (this.props.onError) {\n            this.props.onError(error, this.elementRef);\n        }\n    };\n\n    protected handleAdditionalDetails(state: AdditionalDetailsData): void {\n        this.makeAdditionalDetailsCall(state)\n            .then(sanitizeResponse)\n            .then(verifyPaymentDidNotFail)\n            .then(this.handleResponse)\n            .catch(this.handleFailedResult);\n    }\n\n    private makeAdditionalDetailsCall(state: AdditionalDetailsData): Promise<CheckoutSessionDetailsResponse | CheckoutAdvancedFlowResponse> {\n        if (this.props.onAdditionalDetails) {\n            return new Promise<CheckoutAdvancedFlowResponse>((resolve, reject) => {\n                this.props.onAdditionalDetails(state, this.elementRef, { resolve, reject });\n            });\n        }\n\n        if (this.core.session) {\n            return this.submitAdditionalDetailsUsingSessionsFlow(state.data);\n        }\n\n        this.handleError(\n            new AdyenCheckoutError(\n                'IMPLEMENTATION_ERROR',\n                'It can not perform /payments/details call. Callback \"onAdditionalDetails\" is missing or Checkout session is not available'\n            )\n        );\n    }\n\n    private async submitAdditionalDetailsUsingSessionsFlow(data: any): Promise<CheckoutSessionDetailsResponse> {\n        try {\n            return await this.core.session.submitDetails(data);\n        } catch (error: unknown) {\n            if (error instanceof AdyenCheckoutError) this.handleError(error);\n            else this.handleError(new AdyenCheckoutError('ERROR', 'Error when making /details call', { cause: error }));\n\n            return Promise.reject(error);\n        }\n    }\n\n    public handleAction(action: PaymentAction, props = {}): UIElement | null {\n        if (!action || !action.type) {\n            if (hasOwnProperty(action, 'action') && hasOwnProperty(action, 'resultCode')) {\n                throw new Error(\n                    'handleAction::Invalid Action - the passed action object itself has an \"action\" property and ' +\n                        'a \"resultCode\": have you passed in the whole response object by mistake?'\n                );\n            }\n            throw new Error('handleAction::Invalid Action - the passed action object does not have a \"type\" property');\n        }\n\n        const paymentAction = this.core.createFromAction(action, {\n            ...this.elementRef.props,\n            ...props,\n            onAdditionalDetails: this.handleAdditionalDetails\n        });\n\n        if (paymentAction) {\n            this.unmount();\n            return paymentAction.mount(this._node);\n        }\n\n        return null;\n    }\n\n    protected onActionHandled(actionHandledObj: ActionHandledReturnObject) {\n        this.props?.onActionHandled?.({ originalAction: this.props.originalAction, ...actionHandledObj });\n    }\n\n    protected handleOrder = (response: PaymentResponseData): void => {\n        const { order } = response;\n\n        const updateCorePromise = this.core.session ? this.core.update({ order }) : this.handleAdvanceFlowPaymentMethodsUpdate(order);\n\n        void updateCorePromise.then(() => {\n            this.props.onOrderUpdated?.({ order });\n        });\n    };\n\n    /**\n     * Handles when the payment fails. The payment fails when:\n     * - adv flow: the merchant rejects the payment due to a critical error\n     * - adv flow: the merchant resolves the payment with a failed resultCode\n     * - sessions: a network error occurs when making the payment\n     * - sessions: the payment fails with a failed resultCode\n     *\n     * @param result\n     */\n    protected handleFailedResult = (result?: PaymentResponseData): void => {\n        if (assertIsDropin(this.elementRef)) {\n            this.elementRef.displayFinalAnimation('error');\n        }\n\n        cleanupFinalResult(result);\n        this.props.onPaymentFailed?.(result, this.elementRef);\n    };\n\n    protected handleSuccessResult = (result: PaymentResponseData): void => {\n        if (assertIsDropin(this.elementRef)) {\n            this.elementRef.displayFinalAnimation('success');\n        }\n\n        cleanupFinalResult(result);\n        this.props.onPaymentCompleted?.(result, this.elementRef);\n    };\n\n    /**\n     * Handles a /payments or /payments/details response.\n     * The component will handle automatically actions, orders, and final results.\n     *\n     * @param rawResponse -\n     */\n    protected handleResponse(rawResponse: RawPaymentResponse): void {\n        const response = sanitizeResponse(rawResponse);\n\n        if (response.action) {\n            this.elementRef.handleAction(response.action);\n            return;\n        }\n\n        if (response.order?.remainingAmount?.value > 0) {\n            // we don't want to call elementRef here, use the component handler\n            // we do this way so the logic on handlingOrder is associated with payment method\n            this.handleOrder(response);\n            return;\n        }\n\n        this.handleSuccessResult(response);\n    }\n\n    protected handleKeyPress(e: h.JSX.TargetedKeyboardEvent<HTMLInputElement> | KeyboardEvent) {\n        if (e.key === 'Enter' || e.code === 'Enter') {\n            e.preventDefault(); // Prevent <form> submission if Component is placed inside a form\n\n            this.onEnterKeyPressed(document?.activeElement, this);\n        }\n    }\n\n    /**\n     * Handle Enter key pressed from a UIElement (called via handleKeyPress)\n     * @param obj\n     */\n    protected onEnterKeyPressed(activeElement: Element, component: UIElement) {\n        if (this.props.onEnterKeyPressed) {\n            this.props.onEnterKeyPressed(activeElement, component);\n        } else {\n            (activeElement as HTMLElement).blur();\n            this.submit();\n        }\n    }\n\n    /**\n     * Call update on parent instance\n     * This function exist to make safe access to the protected _parentInstance\n     * @param options - CoreOptions\n     */\n    public updateParent(options: CoreConfiguration = {}): Promise<ICore> {\n        return this.elementRef.core.update(options);\n    }\n\n    public setComponentRef = (ref: ComponentMethodsRef) => {\n        this.componentRef = ref;\n    };\n\n    /**\n     * Get the current validation status of the element\n     */\n    public get isValid(): boolean {\n        return false;\n    }\n\n    /**\n     * Get the element icon URL for the current environment\n     */\n\n    public get icon(): string {\n        const type = this.props.paymentMethodType || this.type;\n        return this.props.icon ?? this.resources.getImage()(type);\n    }\n\n    /**\n     * Get the element's displayable name\n     */\n    public get displayName(): string {\n        const paymentMethodFromResponse = this.core.paymentMethodsResponse?.paymentMethods?.find(pm => pm.type === this.type);\n        return this.props.name || paymentMethodFromResponse?.name || this.type;\n    }\n\n    /**\n     * Get the element accessible name, used in the aria-label of the button that controls selected payment method\n     */\n    public get accessibleName(): string {\n        return this.displayName;\n    }\n\n    /**\n     * Used to display the second line of a payment method item\n     */\n    get additionalInfo(): string {\n        return null;\n    }\n\n    /**\n     * Return the type of an element\n     */\n    public get type(): string {\n        return this.props.type || this.constructor['type'];\n    }\n\n    /**\n     * Get the payButton component for the current element\n     */\n    protected payButton = (props: PayButtonFunctionProps) => {\n        return <PayButton {...props} amount={this.props.amount} secondaryAmount={this.props.secondaryAmount} onClick={this.submit} />;\n    };\n\n    /**\n     * Used in the Partial Orders flow.\n     * When the Order is updated, the merchant can request new payment methods based on the new remaining amount\n     *\n     * @private\n     */\n    protected async handleAdvanceFlowPaymentMethodsUpdate(order: Order | null, amount?: PaymentAmount) {\n        return new Promise<void | PaymentMethodsResponse>((resolve, reject) => {\n            if (!this.props.onPaymentMethodsRequest) {\n                return resolve();\n            }\n\n            this.props.onPaymentMethodsRequest(\n                {\n                    ...(order && {\n                        order: {\n                            orderData: order.orderData,\n                            pspReference: order.pspReference\n                        }\n                    }),\n                    locale: this.core.options.locale\n                },\n                { resolve, reject }\n            );\n        })\n            .catch(error => {\n                this.handleError(\n                    new AdyenCheckoutError(\n                        'IMPLEMENTATION_ERROR',\n                        'Something failed during payment methods update or onPaymentMethodsRequest was not implemented',\n                        {\n                            cause: error\n                        }\n                    )\n                );\n            })\n            .then(paymentMethodsResponse => {\n                // in the case of the session flow we get order, amount, countryCode and shopperLocale from initialize()\n                // apply the same logic here for order and amount\n                // in the future it might be worth moving this logic to be performed by the core on update()\n                // it would make this more consistent\n                return this.core.update({\n                    ...(paymentMethodsResponse && { paymentMethodsResponse }),\n                    order,\n                    amount: order ? order.remainingAmount : amount\n                });\n            });\n    }\n}\n\nexport default UIElement;\n"],"names":["UIElement","BaseElement","buildElementProps","componentProps","finalProps","_object_spread","showPayButton","this","core","getCorePropsForComponent","isStoredPaymentMethod","paymentMethodsResponse","find","type","constructor","isDropin","assertIsDropin","props","formatProps","getRegulatoryDefaults","options","countryCode","storeElementRefOnCore","storeElementReference","isAvailable","Promise","resolve","setState","newState","state","onChange","showValidation","componentRef","setElementStatus","status","_this_elementRef","elementRef","setStatus","_this_componentRef","_this_props_onChange","_this_props","call","data","isValid","errors","valid","setUpAnalytics","setUpAnalyticsObj","_this_props_session","sessionId","session","id","modules","analytics","setUp","submitAnalytics","analyticsObj","uiElementProps","sendAnalytics","getComponent","error","console","warn","component","submit","makePaymentsCall","then","sanitizeResponse","verifyPaymentDidNotFail","handleResponse","catch","e","CancelError","handleFailedResult","onSubmit","submitUsingAdvancedFlow","beforeSubmit","reject","submitUsingSessionsFlow","handleError","AdyenCheckoutError","ANALYTICS_SUBMIT_STR","submitPayment","cause","onComplete","handleAdditionalDetails","makeAdditionalDetailsCall","onAdditionalDetails","submitAdditionalDetailsUsingSessionsFlow","submitDetails","handleAction","action","hasOwnProperty","Error","paymentAction","createFromAction","_object_spread_props","unmount","mount","_node","onActionHandled","actionHandledObj","_this_props_onActionHandled","originalAction","rawResponse","response","order","remainingAmount","value","handleOrder","handleSuccessResult","handleKeyPress","document","key","code","preventDefault","onEnterKeyPressed","activeElement","blur","updateParent","update","icon","paymentMethodType","_this_props_icon","resources","getImage","displayName","_this_core_paymentMethodsResponse_paymentMethods","_this_core_paymentMethodsResponse","paymentMethodFromResponse","paymentMethods","pm","name","accessibleName","additionalInfo","handleAdvanceFlowPaymentMethodsUpdate","amount","onPaymentMethodsRequest","orderData","pspReference","locale","checkout","super","_define_property","onError","_this_props_onOrderUpdated","onOrderUpdated","result","_this_props_onPaymentFailed","displayFinalAnimation","cleanupFinalResult","onPaymentFailed","_this_props_onPaymentCompleted","onPaymentCompleted","setComponentRef","ref","payButton","h","PayButton","secondaryAmount","onClick","register","bind","undefined","txVariants"],"mappings":"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"}
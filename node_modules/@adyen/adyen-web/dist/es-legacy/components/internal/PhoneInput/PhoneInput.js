import{createElement as e}from"../../../external/preact/dist/preact.js";import{useEffect as r,useCallback as o}from"../../../external/preact/hooks/dist/hooks.js";import n from"../FormFields/Field/Field.js";import t from"../../../utils/useForm/useForm.js";import{useCoreContext as l}from"../../../core/Context/CoreProvider.js";import i from"../FormFields/Select/Select.js";import{phoneValidationRules as u,phoneFormatters as a}from"./validate.js";import s from"../FormFields/InputText.js";import p from"../FormFields/Fieldset/Fieldset.js";function c(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function d(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r.push.apply(r,o)}return r}(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})),e}function m(m){var h,f,b,y,g;const{i18n:N}=l(),P=m.requiredFields||[...(null==m||null===(h=m.items)||void 0===h?void 0:h.length)?["phonePrefix"]:[],"phoneNumber"],j=P.includes("phonePrefix")&&!!(null==m||null===(f=m.items)||void 0===f?void 0:f.length),v=P.includes("phoneNumber"),{handleChangeFor:O,data:x,valid:F,errors:k,isValid:w,triggerValidation:S,setSchema:V}=t(d(function(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})))),n.forEach((function(r){c(e,r,o[r])}))}return e}({i18n:N},m),{schema:P,defaultData:m.data,rules:u,formatters:a}));r((()=>{V(P)}),[P.toString()]),r((()=>{x.phoneNumber&&O("phoneNumber","blur")(x.phoneNumber)}),[x.phonePrefix]),r((()=>{m.onChange({data:x,valid:F,errors:k,isValid:w})}),[x,F,k,w]),this.triggerValidation=S;const C=o((e=>{if(k[e]){const o="phoneNumber"===e?"phoneNumberErrorKey":"phonePrefixErrorKey",n=m[o]?m[o]:k[e].errorMessage;var r;return null!==(r=N.get(n))&&void 0!==r?r:null}return null}),[k]);return e(p,{classNameModifiers:["phone-input"]},j&&e(n,{className:"adyen-checkout-field--phone-prefix",label:N.get("telephonePrefix"),errorMessage:C("phonePrefix"),showValidIcon:!1,isValid:F.phonePrefix,dir:"ltr",i18n:N,name:"phonePrefix"},e(i,{className:"adyen-checkout-dropdown adyen-checkout-dropdown--countrycode-selector",name:"phonePrefix",items:m.items,onChange:O("phonePrefix"),placeholder:null==m||null===(b=m.placeholders)||void 0===b?void 0:b.phonePrefix,selectedValue:x.phonePrefix})),v&&e(n,{className:"adyen-checkout-field--phone-number",label:m.phoneNumberKey?N.get(m.phoneNumberKey):N.get("telephoneNumber"),errorMessage:C("phoneNumber"),isValid:F.phoneNumber,filled:(null==x||null===(y=x.phoneNumber)||void 0===y?void 0:y.length)>0,dir:"ltr",i18n:N,name:"phoneNumber"},e(s,{className:"adyen-checkout__input adyen-checkout-input adyen-checkout-input--phone-number",type:"tel",name:"phoneNumber",value:x.phoneNumber,onInput:O("phoneNumber","input"),onBlur:O("phoneNumber","blur"),placeholder:null==m||null===(g=m.placeholders)||void 0===g?void 0:g.phoneNumber,autoCorrect:"off",required:!0})))}m.defaultProps={phoneLabel:"telephoneNumber"};export{m as default};
//# sourceMappingURL=PhoneInput.js.map

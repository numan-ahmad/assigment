import{ANALYTICS_VALIDATION_ERROR_STR as e,ANALYTICS_ACTION_STR as o,errorCodeMapping as n,ALLOWED_ANALYTICS_DATA as t}from"./constants.js";import r from"../../utils/uuid.js";import{digitsOnlyFormatter as s}from"../../utils/Formatters/formatters.js";import{ERROR_FIELD_REQUIRED as i,ERROR_INVALID_FORMAT_EXPECTS as a}from"../Errors/constants.js";import{THREEDS2_FULL as l,DEFAULT_CHALLENGE_WINDOW_SIZE as d}from"../../components/ThreeDS2/constants.js";import u from"../../components/Card/components/CardInput/defaultProps.js";import{DEFAULT_CARD_GROUP_TYPES as c}from"../../components/internal/SecuredFields/lib/constants.js";import{notFalsy as p}from"../../utils/commonUtils.js";function m(e,o,n){return o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e}function g(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{},t=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(o){m(e,o,n[o])}))}return e}function y(e,o){return o=null!=o?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):function(e){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o.push.apply(o,n)}return o}(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})),e}const b=()=>Date.now(),f=n=>g({timestamp:String(b()),component:n.component,id:r()},"error"===n.event&&{code:n.code,errorType:n.errorType,message:n.message},"log"===n.event&&{type:n.type,message:n.message},"log"===n.event&&(n.type===o||n.type===l)&&{subType:n.subtype},"log"===n.event&&n.type===l&&{result:n.result},"info"===n.event&&{type:n.type,target:n.target},"info"===n.event&&n.issuer&&{issuer:n.issuer},"info"===n.event&&{isExpress:n.isExpress,expressPage:n.expressPage},"info"===n.event&&n.isStoredPaymentMethod&&{isStoredPaymentMethod:n.isStoredPaymentMethod,brand:n.brand},"info"===n.event&&n.type===e&&{validationErrorCode:h(n.validationErrorCode,n.target),validationErrorMessage:n.validationErrorMessage},n.configData&&{configData:n.configData},n.metadata&&{metadata:n.metadata}),h=(e,o)=>{var t,r;if(e===i||e===a)return null!==(t=n[`${e}.${o}`])&&void 0!==t?t:e;let l=null!==(r=n[e])&&void 0!==r?r:e;return isNaN(Number(l))&&(l=s(l)),l},v=e=>Object.keys(e).reduce(((o,n)=>(t.includes(n)&&(o[n]=e[n]),o)),{}),O=e=>{var o,n,t,r,s,i,a,l;const{autoFocus:m,billingAddressAllowedCountries:b,billingAddressMode:f,billingAddressRequired:h,billingAddressRequiredFields:v,brands:O=c,brandsConfiguration:S,challengeWindowSize:P=d,configuration:w,countryCode:j,data:C,disclaimerMessage:A,disableIOSArrowKeys:B,doBinLookup:k,enableStoreDetails:D,exposeExpiryDate:E,forceCompat:F,hasHolderName:M,hideCVC:x,holderNameRequired:N,installmentOptions:V,keypadFix:I,legacyInputMode:L,maskSecurityCode:q,minimumExpiryDate:R,name:T,placeholders:K,positionHolderNameOnTop:H,showBrandIcon:z,showInstallmentAmounts:J,showPayButton:W=!1,styles:$,onAllValid:U,onBinLookup:G,onBinValue:Q,onBlur:X,onBrand:Y,onConfigSuccess:Z,onEnterKeyPressed:_,onFieldValid:ee,onFocus:oe,onLoad:ne}=e,te=JSON.stringify(u.data),re=null===(n=e.modules)||void 0===n||null===(o=n.srPanel)||void 0===o?void 0:o.enabled,se=null===(r=e.modules)||void 0===r||null===(t=r.srPanel)||void 0===t?void 0:t.moveFocus,ie=null===(i=e.modules)||void 0===i||null===(s=i.risk)||void 0===s?void 0:s.enabled,ae=e.onAddressLookup?"lookup":f;let le="none";!0===(null==w?void 0:w.koreanAuthenticationRequired)&&(le="kr"===(null==j?void 0:j.toLowerCase())?"atStart":"auto");return y(g({autoFocus:m},(null==b?void 0:b.length)>0&&{billingAddressAllowedCountries:b.toString().substring(0,128)}),{billingAddressMode:ae,billingAddressRequired:h,billingAddressRequiredFields:null==v||null===(a=v.toString())||void 0===a?void 0:a.substring(0,128),brands:null==O||null===(l=O.toString())||void 0===l?void 0:l.substring(0,128),challengeWindowSize:P,disableIOSArrowKeys:B,doBinLookup:k,enableStoreDetails:D,exposeExpiryDate:E,forceCompat:F,hasBrandsConfiguration:p(S),hasData:C&&JSON.stringify(e.data)!==te,hasDisclaimerMessage:!!A,hasHolderName:M,hasInstallmentOptions:p(V),hasPlaceholders:p(K),hasStylesConfigured:p($),hideCVC:x,holderNameRequired:N,keypadFix:I,legacyInputMode:L,maskSecurityCode:q,minimumExpiryDate:!!R,name:T,positionHolderNameOnTop:H,riskEnabled:ie,showBrandIcon:z,showInstallmentAmounts:!!J,showKCPType:le,showPayButton:W,socialSecurityNumberMode:null==w?void 0:w.socialSecurityNumberMode,srPanelEnabled:re,srPanelMoveFocus:se,hasOnAllValid:U!==u.onAllValid,hasOnBinValue:Q!==u.onBinValue,hasOnBlur:X!==u.onBlur,hasOnBrand:Y!==u.onBrand,hasOnConfigSuccess:Z!==u.onConfigSuccess,hasOnFieldValid:ee!==u.onFieldValid,hasOnFocus:oe!==u.onFocus,hasOnLoad:ne!==u.onLoad,hasOnBinLookup:!!G,hasOnEnterKeyPressed:!!_})};export{f as createAnalyticsObject,O as getCardConfigData,b as getUTCTimestamp,v as processAnalyticsData};
//# sourceMappingURL=utils.js.map
